define(["require","exports","chip8/decoder","chip8/registers","chip8/stack","chip8/memory","chip8/timers","chip8/screen","chip8/keypad","chip8/core","chip8/assembler","lib/jquery-2.0.0"],function(n,t,i,r,u,f,e,o,s,h,c){function k(){l.write(512,96),l.write(513,18),l.write(514,96),l.write(515,66),l.write(516,36),l.write(517,4),l.write(1028,166),l.write(1029,0),l.write(1030,0),l.write(1031,238),l.write(518,245),l.write(519,101),l.write(520,133),l.write(521,48),l.write(522,133),l.write(523,68),l.write(1536,1),l.write(1537,2),l.write(1538,3),l.write(1539,4),l.write(1540,5),l.write(524,23),l.load(1792,[104,32,105,16,248,21,249,24,250,7,58,0,23,8,23,4],-1)}function ct(){for(var r,t,i,n=0;n<7;n++){if(r=n-2,t=a.PC+r*2,t<512){$(".code-line-"+n).text("----- ---- ---------");continue}i=w.peekNext(n-2),$(".code-line-"+n).text(y(t,4)+": "+y(i.opcode,4)+" ["+ht.disassemble(i)+"]")}}function y(n,t){return("00000000"+n.toString(16).toUpperCase()).substr(t*-1)}var d=i,g=r,nt=u,tt=f,it=e,rt=o,ut=s,ft=h,et=c,a=new g.chip8.Registers,l=new tt.chip8.Memory,w=new d.chip8.Decoder(l,a),p=new nt.chip8.Stack,v=new it.chip8.Timers,ot=new rt.chip8.Screen,st=new ut.chip8.Keypad,b=new ft.chip8.Core(a,p,l,v,ot,st),ht=new et.chip8.Disassembler;$(document).ready(function(){function i(){if(v.tick(),!b.halted){var n=w.getNext();b.execute(n)}}var t=document.createElement("audio"),n;t.loop=!0,t.autoplay=!1,t.preload="auto",t.src="beep.mp3",k(),a.onWrite.subscribe(function(n,t){$(".variable-"+n+" .variable-value").text(t.toString(16).toUpperCase()),n==="PC"&&ct()}),v.onWrite.subscribe(function(n,t){$(".variable-"+n+" .variable-value").text(y(t,2))}),v.onStartSound.subscribe(function(){$(".sound").addClass("current"),t.currentTime=1,t.play()}),v.onStopSound.subscribe(function(){$(".sound").removeClass("current"),t.pause()}),p.onWrite.subscribe(function(n){$(".variable-SP .variable-value").text(y(n,1))}),a.reset(),$(".cycle").click(function(){i()}),n=null,$(".start").click(function(){n==null?n=setInterval(function(){i()},16):(clearInterval(n),n=null)}),$(".keypad").click(function(){$(".keypad-container").toggleClass("icon-sized"),console.dir(this)}),$(".keypad-button").click(function(n){n.stopPropagation()}),$(".keypad-button").mousedown(function(){$(this).data("isPressed",!0),console.log("Key "+parseInt($(this).data("key"),10).toString(16)+" pressed")}),$(".keypad-button").mouseup(function(){$(this).data("isPressed")&&($(this).data("isPressed",!1),console.log("Key "+parseInt($(this).data("key"),10).toString(16)+" released"))}),$(".keypad-button").mouseout(function(){$(this).data("isPressed")&&($(this).data("isPressed",!1),console.log("Key "+parseInt($(this).data("key"),10).toString(16)+" released"))}),$(".keypad-controls-grabber").click(function(){$(".keypad-controls-container").toggleClass("slide-out")}),$(".reset").click(function(){n&&(clearInterval(n),n=null),l.reset(),k(),p.reset(),v.reset(),a.reset()})})})