define(["require","exports","chip8/decoder","chip8/registers","chip8/stack","chip8/memory","chip8/timers","chip8/screen","chip8/core","chip8/assembler","lib/jquery-2.0.0"],function(n,t,i,r,u,f,e,o,s,h){function ot(){for(var r,t,i,n=0;n<5;n++){if(r=n-2,t=v.PC+r*2,t<512){$(".code-line-"+n).text(" --- --- --- --- ---");continue}i=y.peekNext(n-2),$(".code-line-"+n).text(p(t,4)+": "+p(i.opcode,4)+" ["+et.disassemble(i)+"]")}}function p(n,t){return("00000000"+n.toString(16).toUpperCase()).substr(t*-1)}var b=i,k=r,d=u,g=f,nt=e,tt=o,it=s,rt=h,v=new k.chip8.Registers,c=new g.chip8.Memory,y=new b.chip8.Decoder(c,v),ut=new d.chip8.Stack,a=new nt.chip8.Timers,ft=new tt.chip8.Screen,w=new it.chip8.Core(v,ut,c,a,ft),et=new rt.chip8.Disassembler,l=document.createElement("audio");l.loop=!0,l.autoplay=!1,l.preload="auto",l.src="beep.mp3",$(document).ready(function(){c.write(512,96),c.write(513,18),c.write(514,96),c.write(515,66),c.write(516,36),c.write(517,4),c.write(1028,166),c.write(1029,0),c.write(1030,0),c.write(1031,238),c.write(518,245),c.write(519,101),c.write(520,133),c.write(521,48),c.write(522,133),c.write(523,68),c.write(1536,1),c.write(1537,2),c.write(1538,3),c.write(1539,4),c.write(1540,5),c.write(524,23),c.load(1792,[104,32,105,16,248,21,249,24,250,7,58,0,23,8,23,4],-1),v.onWrite.subscribe(function(n,t){$(".variable-"+n+" .variable-value").text(t.toString(16).toUpperCase()),n==="PC"&&ot()}),a.onWrite.subscribe(function(n,t){$(".variable-"+n+" .variable-value").text(p(t,2))}),a.onStartSound.subscribe(function(){$(".sound").addClass("current"),l.currentTime=1,l.play()}),a.onStopSound.subscribe(function(){$(".sound").removeClass("current"),l.pause()}),v.reset(),$(".cycle").click(function(){a.tick();var n=y.getNext();w.execute(n)});var n=null;$(".start").click(function(){n==null?n=setInterval(function(){a.tick();var n=y.getNext();w.execute(n)},16):(clearInterval(n),n=null)}),$(".keypad").click(function(){$(this).toggleClass("icon-sized"),console.dir(this)}),$(".keypad-button").click(function(n){n.stopPropagation()}),$(".keypad-button").mousedown(function(){$(this).data("isPressed",!0),console.log("Key "+parseInt($(this).data("key"),10).toString(16)+" pressed")}),$(".keypad-button").mouseup(function(){$(this).data("isPressed")&&($(this).data("isPressed",!1),console.log("Key "+parseInt($(this).data("key"),10).toString(16)+" released"))}),$(".keypad-button").mouseout(function(){$(this).data("isPressed")&&($(this).data("isPressed",!1),console.log("Key "+parseInt($(this).data("key"),10).toString(16)+" released"))})})})